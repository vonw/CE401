<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Infrared Absorption by the Atmosphere</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-6bd9cfa162949bde0a231f530c97869d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#definition-of-the-optical-depth" id="toc-definition-of-the-optical-depth" class="nav-link active" data-scroll-target="#definition-of-the-optical-depth">Definition of the Optical Depth</a>
  <ul class="collapse">
  <li><a href="#optical-depth-in-the-atmosphere" id="toc-optical-depth-in-the-atmosphere" class="nav-link" data-scroll-target="#optical-depth-in-the-atmosphere">Optical Depth in the Atmosphere</a></li>
  </ul></li>
  <li><a href="#the-mcclatchey-standard-atmospheres" id="toc-the-mcclatchey-standard-atmospheres" class="nav-link" data-scroll-target="#the-mcclatchey-standard-atmospheres">The McClatchey Standard Atmospheres</a></li>
  <li><a href="#choose-the-standard-atmosphere" id="toc-choose-the-standard-atmosphere" class="nav-link" data-scroll-target="#choose-the-standard-atmosphere">1) Choose the standard atmosphere</a></li>
  <li><a href="#set-the-atmospheric-co2-concentration-in-ppmv" id="toc-set-the-atmospheric-co2-concentration-in-ppmv" class="nav-link" data-scroll-target="#set-the-atmospheric-co2-concentration-in-ppmv">2) Set the atmospheric CO2 concentration (in ppmv)</a>
  <ul class="collapse">
  <li><a href="#pressure-temperature-and-air-density-in-the-standard-atmospheres" id="toc-pressure-temperature-and-air-density-in-the-standard-atmospheres" class="nav-link" data-scroll-target="#pressure-temperature-and-air-density-in-the-standard-atmospheres">Pressure, Temperature, and Air Density in the Standard Atmospheres</a></li>
  <li><a href="#primary-greenhouse-gas-concentrations-in-standard-atmospheres" id="toc-primary-greenhouse-gas-concentrations-in-standard-atmospheres" class="nav-link" data-scroll-target="#primary-greenhouse-gas-concentrations-in-standard-atmospheres">Primary Greenhouse Gas Concentrations in Standard Atmospheres</a></li>
  </ul></li>
  <li><a href="#calculating-optical-depth" id="toc-calculating-optical-depth" class="nav-link" data-scroll-target="#calculating-optical-depth">Calculating Optical Depth</a></li>
  <li><a href="#calculating-atmospheric-transmission" id="toc-calculating-atmospheric-transmission" class="nav-link" data-scroll-target="#calculating-atmospheric-transmission">Calculating Atmospheric Transmission</a>
  <ul class="collapse">
  <li><a href="#as-a-function-of-altitude" id="toc-as-a-function-of-altitude" class="nav-link" data-scroll-target="#as-a-function-of-altitude">As a function of altitude</a></li>
  <li><a href="#transmission-through-the-entire-atmosphere" id="toc-transmission-through-the-entire-atmosphere" class="nav-link" data-scroll-target="#transmission-through-the-entire-atmosphere">Transmission through the entire atmosphere</a></li>
  </ul></li>
  <li><a href="#calculating-atmospheric-absorption-and-emissivity" id="toc-calculating-atmospheric-absorption-and-emissivity" class="nav-link" data-scroll-target="#calculating-atmospheric-absorption-and-emissivity">Calculating Atmospheric Absorption and Emissivity</a>
  <ul class="collapse">
  <li><a href="#as-a-function-of-altitude-1" id="toc-as-a-function-of-altitude-1" class="nav-link" data-scroll-target="#as-a-function-of-altitude-1">As a function of altitude</a></li>
  <li><a href="#absorption-by-the-entire-atmosphere" id="toc-absorption-by-the-entire-atmosphere" class="nav-link" data-scroll-target="#absorption-by-the-entire-atmosphere">Absorption by the entire atmosphere</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Infrared Absorption by the Atmosphere</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><i>© Von P. Walden, Washington State University</i></p>
<div id="dd37987e-0f23-46a4-a58f-ffe80536193c" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="definition-of-the-optical-depth" class="level2">
<h2 class="anchored" data-anchor-id="definition-of-the-optical-depth">Definition of the Optical Depth</h2>
<p>To calculate the infrared absorption by the atmosphere, we must calculate the optical depth. The optical depth is related to the transmission of radiation through “optical media”, such as an absorbing gas or an absorbing liquid. <a href="https://en.wikipedia.org/wiki/Beer–Lambert_law">Beer’s Law</a> gives us</p>
<p><span class="math display">\[ I(\lambda) = I_o(\lambda) e^{-\tau} \]</span></p>
<p>This can be rewritten as</p>
<p><span class="math display">\[ Transmission = \frac{I(\lambda)}{I_o(\lambda)} = e^{-\tau} \]</span></p>
<p>Then one can solve for the optical depth <span class="math inline">\(\tau\)</span> as</p>
<p><span class="math display">\[ \tau = -ln \Big[ \frac{I(\lambda)}{I_o(\lambda)} \Big] \]</span></p>
<p>In general, the optical depth is:</p>
<p><span class="math display">\[ \tau = \int_{z_1}^{z_2} \beta_{\lambda} dz = \int_{z_1}^{z_2} \kappa_{\lambda} \rho (z) dz = \int_{z_1}^{z_2} \sigma_{\lambda} n(z) dz \]</span></p>
<p>where - <span class="math inline">\(\beta\)</span> is the volume absorption coefficient, - <span class="math inline">\(\kappa\)</span> is the mass absorption coefficient, - <span class="math inline">\(\sigma\)</span> is the absorption cross section,</p>
<p>which all depend on wavelength, <span class="math inline">\(\lambda\)</span>.</p>
<p><span class="math inline">\(\rho(z)\)</span> and n(z) are the air density and the number density of the absorbing gas. z is distance along the absorbing path from <span class="math inline">\(z_1\)</span> to <span class="math inline">\(z_2\)</span>.</p>
<p>If one conducts an experiment of Beer’s Law in the lab using a tube filled with an absorbing gas (like H2O or CO2), this equation reduces to:</p>
<p><span class="math display">\[ \tau = \beta (z_2 - z_1) = \kappa_{\lambda} \rho (z_2 - z_1) = \sigma_{\lambda} N (z_2 - z_1) \]</span></p>
<p>Note that this is how scientists (100 or so years ago) determined how different gases absorbed infrared radiation at different wavelengths, by measuring the transmission of radiation through the gas, calculating the optical depth, then solving for either <span class="math inline">\(\beta_{\lambda}\)</span>, <span class="math inline">\(\kappa_{\lambda}\)</span>, or <span class="math inline">\(\sigma_{\lambda}\)</span>.</p>
<section id="optical-depth-in-the-atmosphere" class="level3">
<h3 class="anchored" data-anchor-id="optical-depth-in-the-atmosphere">Optical Depth in the Atmosphere</h3>
<p>To determine the optical depth in the atmosphere, one must use the general equation above, because the number of molecules of absorbing gas changes with height in the atmosphere. Carbon dioxide is “uniformly mixed” in the atmosphere, meaning that its concentration relative to other gases does not change with height. However, the actual number of CO2 molecules decreases exponentially with height in the atmosphere because the density (and pressure) of the air decreases in this manner. Most of the water vapor in the atmosphere is contained only in the troposphere in the lowest 7 or 8 km. Therefore, one must integrate through the atmosphere to determine the optical depth using:</p>
<p><span class="math display">\[ \tau = \int_{z_1}^{z_2} \kappa_{\lambda} \rho (z) dz \]</span></p>
<p>Here we have chosen to use the specific formula of the optical depth that contains the mass absorption coefficient, because Figure 2 of Pierrehumbert (2010) gives values of <span class="math inline">\(\kappa\)</span> for both H2O and CO2.</p>
</section>
</section>
<section id="the-mcclatchey-standard-atmospheres" class="level2">
<h2 class="anchored" data-anchor-id="the-mcclatchey-standard-atmospheres">The McClatchey Standard Atmospheres</h2>
<p>We’re lucky because <a href="https://apps.dtic.mil/sti/pdfs/AD0753075.pdf">McClatchey et al (1972)</a> [in Optical Properties of the Atmosphere (Third Edition)] created a series of “standard atmospheres” for different locations and seasons on Earth that give us n(z) as a function of altitude (z) in the atmosphere. The McClatchey Standard Atmospheres are for:</p>
<ul>
<li>Tropics (TRP)</li>
<li>Mid-latitude Summer (MLS)</li>
<li>Mid-latitude Winter (MLW)</li>
<li>Sub-Arctic Summer (SAS)</li>
<li>Sub-Arctic Winter (SAW)</li>
</ul>
<div id="bb523c6a-db8f-48cf-87e4-9d705f06c4fe" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in raw data files</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [<span class="st">'layer'</span>, <span class="st">'altitude'</span>, <span class="st">'pressure'</span>, <span class="st">'temperature'</span>, <span class="st">'dew_point'</span>, <span class="st">'density'</span>, <span class="st">'h2o'</span>, <span class="st">'co2'</span>, <span class="st">'o3'</span>, <span class="st">'n2o'</span>, <span class="st">'co'</span>, <span class="st">'ch4'</span>, <span class="st">'o2'</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>trp <span class="op">=</span> pd.read_table(<span class="st">'trp.dat'</span>, sep<span class="op">=</span><span class="st">'\s+'</span>, names<span class="op">=</span>columns)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>mls <span class="op">=</span> pd.read_table(<span class="st">'mls.dat'</span>, sep<span class="op">=</span><span class="st">'\s+'</span>, names<span class="op">=</span>columns)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>mlw <span class="op">=</span> pd.read_table(<span class="st">'mlw.dat'</span>, sep<span class="op">=</span><span class="st">'\s+'</span>, names<span class="op">=</span>columns)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>sas <span class="op">=</span> pd.read_table(<span class="st">'sas.dat'</span>, sep<span class="op">=</span><span class="st">'\s+'</span>, names<span class="op">=</span>columns)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>saw <span class="op">=</span> pd.read_table(<span class="st">'saw.dat'</span>, sep<span class="op">=</span><span class="st">'\s+'</span>, names<span class="op">=</span>columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="659a37f4" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Rair <span class="op">=</span> <span class="fl">287.058</span>        <span class="co"># J kg-1 K-1</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate air density</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>trp.rename({<span class="st">'density'</span>: <span class="st">'numberDensity'</span>})</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>trp[<span class="st">'airDensity'</span>] <span class="op">=</span> (trp.pressure <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> (Rair <span class="op">*</span> trp.temperature)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>mls.rename({<span class="st">'density'</span>: <span class="st">'numberDensity'</span>})</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>mls[<span class="st">'airDensity'</span>] <span class="op">=</span> (mls.pressure <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> (Rair <span class="op">*</span> mls.temperature)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>mlw.rename({<span class="st">'density'</span>: <span class="st">'numberDensity'</span>})</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>mlw[<span class="st">'airDensity'</span>] <span class="op">=</span> (mlw.pressure <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> (Rair <span class="op">*</span> mlw.temperature)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>sas.rename({<span class="st">'density'</span>: <span class="st">'numberDensity'</span>})</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>sas[<span class="st">'airDensity'</span>] <span class="op">=</span> (sas.pressure <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> (Rair <span class="op">*</span> sas.temperature)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>saw.rename({<span class="st">'density'</span>: <span class="st">'numberDensity'</span>})</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>saw[<span class="st">'airDensity'</span>] <span class="op">=</span> (saw.pressure <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> (Rair <span class="op">*</span> saw.temperature)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="05df41d4-dda4-4e35-bf5f-9d53b4ec7481" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpolate the standard atmospheres to a common grid in meters with heights every 100 meters</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>trp.index <span class="op">=</span> trp.altitude<span class="op">*</span><span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>trp <span class="op">=</span> trp.reindex(np.arange(<span class="dv">0</span>,<span class="dv">60001</span>,<span class="dv">100</span>)).interpolate(method<span class="op">=</span><span class="st">'linear'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>mls.index <span class="op">=</span> mls.altitude<span class="op">*</span><span class="dv">1000</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>mls <span class="op">=</span> mls.reindex(np.arange(<span class="dv">0</span>,<span class="dv">60001</span>,<span class="dv">100</span>)).interpolate(method<span class="op">=</span><span class="st">'linear'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>mlw.index <span class="op">=</span> mlw.altitude<span class="op">*</span><span class="dv">1000</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>mlw <span class="op">=</span> mlw.reindex(np.arange(<span class="dv">0</span>,<span class="dv">60001</span>,<span class="dv">100</span>)).interpolate(method<span class="op">=</span><span class="st">'linear'</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>sas.index <span class="op">=</span> sas.altitude<span class="op">*</span><span class="dv">1000</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>sas <span class="op">=</span> sas.reindex(np.arange(<span class="dv">0</span>,<span class="dv">60001</span>,<span class="dv">100</span>)).interpolate(method<span class="op">=</span><span class="st">'linear'</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>saw.index <span class="op">=</span> saw.altitude<span class="op">*</span><span class="dv">1000</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>saw <span class="op">=</span> saw.reindex(np.arange(<span class="dv">0</span>,<span class="dv">60001</span>,<span class="dv">100</span>)).interpolate(method<span class="op">=</span><span class="st">'linear'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="choose-the-standard-atmosphere" class="level2">
<h2 class="anchored" data-anchor-id="choose-the-standard-atmosphere">1) Choose the standard atmosphere</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Standard Atmosphere</th>
<th>stdatm_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tropical</td>
<td>‘trp’</td>
</tr>
<tr class="even">
<td>Mid-Latitude Summer</td>
<td>‘mls’</td>
</tr>
<tr class="odd">
<td>Mid-Latitude Winter</td>
<td>‘mlw’</td>
</tr>
<tr class="even">
<td>Sub-Arctic Summer</td>
<td>‘sas’</td>
</tr>
<tr class="odd">
<td>Sub-Arctic Winter</td>
<td>‘saw’</td>
</tr>
</tbody>
</table>
<div id="c4145b87" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change this variable to choose the model atmosphere</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># !! </span><span class="al">NOTE</span><span class="co"> that the single quotation marks are important !!</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>stdatm_name <span class="op">=</span> <span class="st">'mlw'</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'trp'</span> <span class="kw">in</span> stdatm_name:</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    stdatm <span class="op">=</span> trp</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> <span class="st">'mls'</span> <span class="kw">in</span> stdatm_name:</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    stdatm <span class="op">=</span> mls</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> <span class="st">'mlw'</span> <span class="kw">in</span> stdatm_name:</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    stdatm <span class="op">=</span> mlw</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> <span class="st">'sas'</span> <span class="kw">in</span> stdatm_name:</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    stdatm <span class="op">=</span> sas</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> <span class="st">'saw'</span> <span class="kw">in</span> stdatm_name:</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    stdatm <span class="op">=</span> saw</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"ERROR: This standard atmosphere is NOT RECOGNIZED. Try setting stdatm_name again!!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-the-atmospheric-co2-concentration-in-ppmv" class="level2">
<h2 class="anchored" data-anchor-id="set-the-atmospheric-co2-concentration-in-ppmv">2) Set the atmospheric CO2 concentration (in ppmv)</h2>
<div id="9008fcc5-f939-4bf3-b2f6-687866f24cb1" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set CO2 in all Standard Atmospheres.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#co2 = 330.   # ppmv; approximate concentration in 1971</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#co2 = 420.   # ppmv; current concentration in 2024</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#co2 = 280.   # ppmv; pre-industrial concentration</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>co2 <span class="op">=</span> <span class="fl">560.</span>   <span class="co"># ppmv; doubled CO2 concentration (from pre-industrial)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>trp[<span class="st">'co2'</span>] <span class="op">=</span> mls[<span class="st">'co2'</span>] <span class="op">=</span> mlw[<span class="st">'co2'</span>] <span class="op">=</span> sas[<span class="st">'co2'</span>] <span class="op">=</span> saw[<span class="st">'co2'</span>] <span class="op">=</span> co2<span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="pressure-temperature-and-air-density-in-the-standard-atmospheres" class="level3">
<h3 class="anchored" data-anchor-id="pressure-temperature-and-air-density-in-the-standard-atmospheres">Pressure, Temperature, and Air Density in the Standard Atmospheres</h3>
<div id="25b89e96-4fbe-480a-a86c-1b411ca3b58a" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="23">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2, ax3) <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>), nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pressure</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>trp.plot(ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">'pressure'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>mls.plot(ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">'pressure'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>mlw.plot(ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">'pressure'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>sas.plot(ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">'pressure'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>saw.plot(ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">'pressure'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Pressure (mb)'</span>)<span class="op">;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Altitude (km)'</span>)<span class="op">;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Atmospheric Pressure for Standard Atmospheres'</span>)<span class="op">;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>ax1.legend([<span class="st">'TRP'</span>,<span class="st">'MLS'</span>,<span class="st">'MLW'</span>,<span class="st">'SAS'</span>,<span class="st">'SAW'</span>])<span class="op">;</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>trp.plot(ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">'temperature'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>mls.plot(ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">'temperature'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>mlw.plot(ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">'temperature'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>sas.plot(ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">'temperature'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>saw.plot(ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">'temperature'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>ax2.grid()</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Temperature (K)'</span>)<span class="op">;</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Altitude (km)'</span>)<span class="op">;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Temperature Profiles for Standard Atmospheres'</span>)<span class="op">;</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>ax2.legend([<span class="st">'TRP'</span>,<span class="st">'MLS'</span>,<span class="st">'MLW'</span>,<span class="st">'SAS'</span>,<span class="st">'SAW'</span>])<span class="op">;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#O3</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>trp.plot(ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">'airDensity'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>mls.plot(ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">'airDensity'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>mlw.plot(ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">'airDensity'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>sas.plot(ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">'airDensity'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>saw.plot(ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">'airDensity'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>ax3.grid()</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Density (kg m-3)'</span>)<span class="op">;</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Altitude (km)'</span>)<span class="op">;</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Density of Air for Standard Atmospheres'</span>)<span class="op">;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>ax3.legend([<span class="st">'TRP'</span>,<span class="st">'MLS'</span>,<span class="st">'MLW'</span>,<span class="st">'SAS'</span>,<span class="st">'SAW'</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="InfraredAbsorptionByTheAtmosphere_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="primary-greenhouse-gas-concentrations-in-standard-atmospheres" class="level3">
<h3 class="anchored" data-anchor-id="primary-greenhouse-gas-concentrations-in-standard-atmospheres">Primary Greenhouse Gas Concentrations in Standard Atmospheres</h3>
<div id="5fb0c120-53d0-4dc2-b8bb-f8a0529a2928" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="24">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2, ax3) <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>), nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># H2O</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>trp.plot(ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">'h2o'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>mls.plot(ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">'h2o'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>mlw.plot(ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">'h2o'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>sas.plot(ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">'h2o'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>saw.plot(ax<span class="op">=</span>ax1, x<span class="op">=</span><span class="st">'h2o'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>ax1.grid()</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Water Vapor (ppmv)'</span>)<span class="op">;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Altitude (km)'</span>)<span class="op">;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Water Vapor concentration for Standard Atmospheres'</span>)<span class="op">;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>ax1.legend([<span class="st">'TRP'</span>,<span class="st">'MLS'</span>,<span class="st">'MLW'</span>,<span class="st">'SAS'</span>,<span class="st">'SAW'</span>])<span class="op">;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># CO2</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>trp.plot(ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">'co2'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>mls.plot(ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">'co2'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>mlw.plot(ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">'co2'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>sas.plot(ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">'co2'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>saw.plot(ax<span class="op">=</span>ax2, x<span class="op">=</span><span class="st">'co2'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>ax2.grid()</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Carbon Dioxide (ppmv)'</span>)<span class="op">;</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Altitude (km)'</span>)<span class="op">;</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Carbon Dioxide concentration for Standard Atmospheres'</span>)<span class="op">;</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>ax2.legend([<span class="st">'TRP'</span>,<span class="st">'MLS'</span>,<span class="st">'MLW'</span>,<span class="st">'SAS'</span>,<span class="st">'SAW'</span>])<span class="op">;</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co">#O3</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>trp.plot(ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">'o3'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>mls.plot(ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">'o3'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>mlw.plot(ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">'o3'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>sas.plot(ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">'o3'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>saw.plot(ax<span class="op">=</span>ax3, x<span class="op">=</span><span class="st">'o3'</span>, y<span class="op">=</span><span class="st">'altitude'</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>ax3.grid()</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Ozone (ppmv)'</span>)<span class="op">;</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Altitude (km)'</span>)<span class="op">;</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Ozone concentration for Standard Atmospheres'</span>)<span class="op">;</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>ax3.legend([<span class="st">'TRP'</span>,<span class="st">'MLS'</span>,<span class="st">'MLW'</span>,<span class="st">'SAS'</span>,<span class="st">'SAW'</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="InfraredAbsorptionByTheAtmosphere_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="calculating-optical-depth" class="level2">
<h2 class="anchored" data-anchor-id="calculating-optical-depth">Calculating Optical Depth</h2>
<p>Now that we have values for the air density and the concentrations of the greenhouse gases, it is easy to calculate the optical depth for individual gases.</p>
<p>We will use mass absorption coefficients for carbon dioxide at the following wavelengths (from the center of the 15-um CO2 band towards the atmospheric window between 8 and 12.5 um):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 25%">
<col style="width: 21%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Type of Absorption</th>
<th>Wavenumber (<span class="math inline">\(cm^{-1}\)</span>)</th>
<th>Wavelength (<span class="math inline">\(\mu\)</span>m)</th>
<th><span class="math inline">\(\kappa_a\)</span> (<span class="math inline">\(m^2 kg^{-1}\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Very Strong</td>
<td>667</td>
<td>15</td>
<td>2000</td>
</tr>
<tr class="even">
<td>Very Strong</td>
<td>714</td>
<td>14</td>
<td>10</td>
</tr>
<tr class="odd">
<td>Moderate</td>
<td>769</td>
<td>13</td>
<td>0.1</td>
</tr>
<tr class="even">
<td>Weak</td>
<td>833</td>
<td>12</td>
<td>0.001</td>
</tr>
</tbody>
</table>
<p>These mass absorption coefficients values were <em>approximated</em> from Figure 2 in Pierrehumbert, Physics Today, January 2011.</p>
<p>So, the optical depth can now be calculated for each layer of the atmosphere by multiplying the absorption cross sections (<span class="math inline">\(\kappa_a\)</span>) by the air density, and then by the thickness of the atmospheric layer, as shown in the code below (for the Mid-latitude Winter Standard Atmosphere - MLW).</p>
<p><strong>Disclaimer:</strong> Please note that this calculation of optical depth is for illustrative purposes only, and is over-simplified in the following ways:</p>
<ul>
<li><p>In most cases H2O overlaps the absorption bands of all the other GH gases. (See Figure 2 of Pierrehumbert (2010); blowup of 600-670 cm-1).</p></li>
<li><p>We are neglecting how the line strengths of absorption lines depend on temperature in the atmosphere (https://hitran.org/docs/definitions-and-units/)</p></li>
<li><p>We are neglecting how the widths of absorption lines depend on both temperature and pressure (https://hitran.org/docs/definitions-and-units/)</p></li>
</ul>
<p>Accurate radiative transfer models of the atmosphere account for all of this issues.</p>
<div id="f15d6443-f485-4716-9ea7-13de08bfa4fe" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Ka_15 <span class="op">=</span> <span class="dv">2000</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>Ka_14 <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>Ka_13 <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>Ka_12 <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>rhoCO2 <span class="op">=</span> stdatm.airDensity[:<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> stdatm.co2[:<span class="op">-</span><span class="dv">1</span>]<span class="op">/</span><span class="fl">1e6</span>     <span class="co"># Convert from ppmv to percent fraction</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>dz   <span class="op">=</span> np.diff(stdatm.altitude) <span class="op">*</span> <span class="dv">1000</span>                 <span class="co"># Calculate the height of each layer by differencing levels; meters</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and plot the optical depth at 14.6 um for CO2 for the MLW Standard Atmosphere.</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'od_15'</span>] <span class="op">=</span> Ka_15 <span class="op">*</span> rhoCO2 <span class="op">*</span> dz</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'od_14'</span>] <span class="op">=</span> Ka_14 <span class="op">*</span> rhoCO2 <span class="op">*</span> dz</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'od_13'</span>] <span class="op">=</span> Ka_13 <span class="op">*</span> rhoCO2 <span class="op">*</span> dz</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'od_12'</span>] <span class="op">=</span> Ka_12 <span class="op">*</span> rhoCO2 <span class="op">*</span> dz</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e3beb853-3cc3-4117-bb4e-7a0155f2bb38" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="26">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'od_15'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>, logy<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'od_14'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>, logy<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'od_13'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>, logy<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'od_12'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>, logy<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Optical Depth'</span>)<span class="op">;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Altitude (km)'</span>)<span class="op">;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Infrared Optical Depths for CO2 in '</span> <span class="op">+</span> stdatm_name <span class="op">+</span> <span class="st">'Standard Atmospheres'</span>)<span class="op">;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>ax.legend([<span class="st">'15 um'</span>,<span class="st">'14 um'</span>,<span class="st">'13 um'</span>,<span class="st">'12 um'</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="InfraredAbsorptionByTheAtmosphere_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculating-atmospheric-transmission" class="level2">
<h2 class="anchored" data-anchor-id="calculating-atmospheric-transmission">Calculating Atmospheric Transmission</h2>
<section id="as-a-function-of-altitude" class="level3">
<h3 class="anchored" data-anchor-id="as-a-function-of-altitude">As a function of altitude</h3>
<div id="9fa8c6e8-2cca-4b29-8a33-c5f7a9fc63f2" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'T_15'</span>] <span class="op">=</span> np.exp(<span class="op">-</span>stdatm.od_15) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'T_14'</span>] <span class="op">=</span> np.exp(<span class="op">-</span>stdatm.od_14) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'T_13'</span>] <span class="op">=</span> np.exp(<span class="op">-</span>stdatm.od_13) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'T_12'</span>] <span class="op">=</span> np.exp(<span class="op">-</span>stdatm.od_12) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5d76b3fb-07c2-4d8e-8976-7f9a1556a65d" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="28">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'T_15'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'T_14'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'T_13'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'T_12'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>ax.axis([<span class="fl">0.1</span>, <span class="dv">120</span>, <span class="dv">0</span>, <span class="dv">60</span>])</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Transmission'</span>)<span class="op">;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Altitude (km)'</span>)<span class="op">;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Infrared Transmission for CO2 in '</span> <span class="op">+</span> stdatm_name <span class="op">+</span> <span class="st">'Standard Atmospheres'</span>)<span class="op">;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>ax.legend([<span class="st">'15 um'</span>,<span class="st">'14 um'</span>,<span class="st">'13 um'</span>,<span class="st">'12 um'</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="InfraredAbsorptionByTheAtmosphere_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="transmission-through-the-entire-atmosphere" class="level3">
<h3 class="anchored" data-anchor-id="transmission-through-the-entire-atmosphere">Transmission through the entire atmosphere</h3>
<p>The above figure shows the transmission as a function of altitude in the atmosphere. But how do we calculate the transmission through the entire atmosphere?</p>
<p>There are two ways to do this:</p>
<ol type="1">
<li>Multiply all the transmission from each layer together, or</li>
</ol>
<p><span class="math display">\[ T_{total} = e^{- \tau_1} e^{- \tau_2} e^{- \tau_3} ... \]</span></p>
<ol start="2" type="1">
<li>Or (because of the properties of exponents) one can just add up all the optical depths for each layer and take the exponential of that sum</li>
</ol>
<p><span class="math display">\[ T_{total} = e^{- \tau_1} e^{- \tau_2} e^{- \tau_3} ... = e^{- (\tau_1 +  \tau_2 + \tau_3 ...)} \]</span></p>
<p>Option 2 is much easier for us here; see the code below.</p>
<div id="1de8155f-105e-4733-933b-ec1f3cd782e8" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total transmission in the atmosphere by summing all optical depths</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Ttotal_15 <span class="op">=</span> np.exp(<span class="op">-</span>stdatm.od_15.<span class="bu">sum</span>())</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>Ttotal_14 <span class="op">=</span> np.exp(<span class="op">-</span>stdatm.od_14.<span class="bu">sum</span>())</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Ttotal_13 <span class="op">=</span> np.exp(<span class="op">-</span>stdatm.od_13.<span class="bu">sum</span>())</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>Ttotal_12 <span class="op">=</span> np.exp(<span class="op">-</span>stdatm.od_12.<span class="bu">sum</span>())</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Total transmission in atmosphere (%) at 15 um = </span><span class="sc">{</span>Ttotal_15<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss"> %'</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Total transmission in atmosphere (%) at 14 um = </span><span class="sc">{</span>Ttotal_14<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss"> %'</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Total transmission in atmosphere (%) at 13 um = </span><span class="sc">{</span>Ttotal_13<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss"> %'</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Total transmission in atmosphere (%) at 12 um = </span><span class="sc">{</span>Ttotal_12<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss"> %'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total transmission in atmosphere (%) at 15 um = 0.00 %
Total transmission in atmosphere (%) at 14 um = 0.00 %
Total transmission in atmosphere (%) at 13 um = 55.59 %
Total transmission in atmosphere (%) at 12 um = 99.41 %</code></pre>
</div>
</div>
</section>
</section>
<section id="calculating-atmospheric-absorption-and-emissivity" class="level2">
<h2 class="anchored" data-anchor-id="calculating-atmospheric-absorption-and-emissivity">Calculating Atmospheric Absorption and Emissivity</h2>
<p>An important property of thermal radiation is given by <a href="https://en.wikipedia.org/wiki/Kirchhoff%27s_law_of_thermal_radiation">Kirchhoff’s Law</a>. It states that</p>
<pre><code>"For an arbitrary body emitting and absorbing thermal radiation in thermodynamic equilibrium, the emissivity is equal to the absorptivity."</code></pre>
<p>We don’t have time to discuss this in CE401, but it states that a good emitter (high emissivity object) is an equally good absorber.</p>
<p>This holds true for the atmosphere as well. So, if we calculate the absorption of the atmosphere as</p>
<p><span class="math display">\[ Absorption = 1 - Transmission \]</span></p>
<p>then also</p>
<p><span class="math display">\[ Emissivity = 1 - Transmission \]</span></p>
<section id="as-a-function-of-altitude-1" class="level3">
<h3 class="anchored" data-anchor-id="as-a-function-of-altitude-1">As a function of altitude</h3>
<div id="6b8b9d3e-7ade-4caf-b88d-2f04281bc111" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'A_15'</span>] <span class="op">=</span> (<span class="fl">1.</span> <span class="op">-</span> np.exp(<span class="op">-</span>stdatm.od_15)) <span class="op">*</span> <span class="dv">100</span>        <span class="co"># Convert from fraction to percent</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'A_14'</span>] <span class="op">=</span> (<span class="fl">1.</span> <span class="op">-</span> np.exp(<span class="op">-</span>stdatm.od_14)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'A_13'</span>] <span class="op">=</span> (<span class="fl">1.</span> <span class="op">-</span> np.exp(<span class="op">-</span>stdatm.od_13)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>stdatm[<span class="st">'A_12'</span>] <span class="op">=</span> (<span class="fl">1.</span> <span class="op">-</span> np.exp(<span class="op">-</span>stdatm.od_12)) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="67b4d3d7-6b25-4b48-b64d-ad9713beac90" class="cell" data-tags="[&quot;hide-input&quot;]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'A_15'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'A_14'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'A_13'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>stdatm.plot(ax<span class="op">=</span>ax, x<span class="op">=</span><span class="st">'A_12'</span>, y<span class="op">=</span><span class="st">'altitude'</span>, logx<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Absorption'</span>)<span class="op">;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Altitude (km)'</span>)<span class="op">;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Infrared Absorption for CO2 in '</span> <span class="op">+</span> stdatm_name <span class="op">+</span> <span class="st">'Standard Atmospheres'</span>)<span class="op">;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>ax.legend([<span class="st">'15 um'</span>,<span class="st">'14 um'</span>,<span class="st">'13 um'</span>,<span class="st">'12 um'</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="InfraredAbsorptionByTheAtmosphere_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="absorption-by-the-entire-atmosphere" class="level3">
<h3 class="anchored" data-anchor-id="absorption-by-the-entire-atmosphere">Absorption by the entire atmosphere</h3>
<div id="5338db1f-1f6e-41a5-a2a1-a95851a5a94a" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Total absorption in atmosphere (%) at 15 um = </span><span class="sc">{</span>(<span class="dv">1</span> <span class="op">-</span> Ttotal_15)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss"> %'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Total absorption in atmosphere (%) at 14 um = </span><span class="sc">{</span>(<span class="dv">1</span> <span class="op">-</span> Ttotal_14)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss"> %'</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Total absorption in atmosphere (%) at 13 um = </span><span class="sc">{</span>(<span class="dv">1</span> <span class="op">-</span> Ttotal_13)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss"> %'</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Total absorption in atmosphere (%) at 12 um = </span><span class="sc">{</span>(<span class="dv">1</span> <span class="op">-</span> Ttotal_12)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss"> %'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Total absorption in atmosphere (%) at 15 um = 100.00 %
Total absorption in atmosphere (%) at 14 um = 100.00 %
Total absorption in atmosphere (%) at 13 um = 29.25 %
Total absorption in atmosphere (%) at 12 um = 0.35 %</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/vonw\.github\.io\/CE401\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>