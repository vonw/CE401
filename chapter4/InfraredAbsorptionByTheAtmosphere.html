

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Infrared Absorption by the Atmosphere &#8212; Climate Change Science and Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter4/InfraredAbsorptionByTheAtmosphere';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Calculation of the Equilibrium Temperature of Earth" href="EquilibriumTemperatureOfEarth.html" />
    <link rel="prev" title="Insolation" href="Insolation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ce401.png" class="logo__image only-light" alt="Climate Change Science and Engineering - Home"/>
    <script>document.write(`<img src="../_static/ce401.png" class="logo__image only-dark" alt="Climate Change Science and Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Computational Notebooks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter0.html">Using Python</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter0/softwareCarpentry_PythonFundamentals.html">Software Carpentry - Python Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter0/softwareCarpentry_AnalyzingPatientData.html">Software Carpentry - Analyzing Patient Data</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter1.html">An Introduction to the Climate Problem</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter1/FairbanksTemperatures.html">Comparing temperature distributions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter2.html">Is the Climate Changing?</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter2/LaurentideIceSheet_and_SeaLevel.html">Approximate the Decrease in Sea-level from the Laurentide Ice Sheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter2/plotBerkeleyEarth.html">Plot global temperature anomalies from Berkeley Earth</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter3.html">Radiation and Energy Balance</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/PlancksLaw.html">Calculate Planck curves as a function of wavelength and temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/RadiationInSpectralBands.html">Calculate Percentage of Radiation in Spectral Bands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/PowerEmittedByHuman.html">Calculate the Power Emitted by a Human</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/BodiesEmittingInARoom.html">Bodies Emitting in a Room</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../chapter4.html">A Simple Climate Model</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="SolarConstant.html">Calculation of the Solar Constant</a></li>
<li class="toctree-l2"><a class="reference internal" href="Insolation.html">Insolation</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Infrared Absorption by the Atmosphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="EquilibriumTemperatureOfEarth.html">Calculation of the Equilibrium Temperature of Earth</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../chapter10.html">Exponential Growth</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter10/ExponentialGrowth_Dessler.html">Exponential Growth</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/vonw/CE401/main?urlpath=tree/chapter4/InfraredAbsorptionByTheAtmosphere.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/vonw/CE401" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/vonw/CE401/issues/new?title=Issue%20on%20page%20%2Fchapter4/InfraredAbsorptionByTheAtmosphere.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapter4/InfraredAbsorptionByTheAtmosphere.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Infrared Absorption by the Atmosphere</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-of-the-optical-depth">Definition of the Optical Depth</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optical-depth-in-the-atmosphere">Optical Depth in the Atmosphere</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-mcclatchey-standard-atmospheres">The McClatchey Standard Atmospheres</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-standard-atmosphere">1) Choose the standard atmosphere</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-atmospheric-co2-concentration-in-ppmv">2) Set the atmospheric CO2 concentration (in ppmv)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pressure-temperature-and-air-density-in-the-standard-atmospheres">Pressure, Temperature, and Air Density in the Standard Atmospheres</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#primary-greenhouse-gas-concentrations-in-standard-atmospheres">Primary Greenhouse Gas Concentrations in Standard Atmospheres</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-optical-depth">Calculating Optical Depth</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-atmospheric-transmission">Calculating Atmospheric Transmission</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#as-a-function-of-altitude">As a function of altitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transmission-through-the-entire-atmosphere">Transmission through the entire atmosphere</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-atmospheric-absorption-and-emissivity">Calculating Atmospheric Absorption and Emissivity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">As a function of altitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#absorption-by-the-entire-atmosphere">Absorption by the entire atmosphere</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="infrared-absorption-by-the-atmosphere">
<h1>Infrared Absorption by the Atmosphere<a class="headerlink" href="#infrared-absorption-by-the-atmosphere" title="Permalink to this heading">#</a></h1>
<p><i>© Von P. Walden, Washington State University</i></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<section id="definition-of-the-optical-depth">
<h2>Definition of the Optical Depth<a class="headerlink" href="#definition-of-the-optical-depth" title="Permalink to this heading">#</a></h2>
<p>To calculate the infrared absorption by the atmosphere, we must calculate the optical depth.  The optical depth is related to the transmission of radiation through “optical media”, such as an absorbing gas or an absorbing liquid. <a class="reference external" href="https://en.wikipedia.org/wiki/Beer%E2%80%93Lambert_law">Beer’s Law</a> gives us</p>
<div class="math notranslate nohighlight">
\[ I(\lambda) = I_o(\lambda) e^{-\tau} \]</div>
<p>This can be rewritten as</p>
<div class="math notranslate nohighlight">
\[ Transmission = \frac{I(\lambda)}{I_o(\lambda)} = e^{-\tau} \]</div>
<p>Then one can solve for the optical depth <span class="math notranslate nohighlight">\(\tau\)</span> as</p>
<div class="math notranslate nohighlight">
\[ \tau = -ln \Big[ \frac{I(\lambda)}{I_o(\lambda)} \Big] \]</div>
<p>In general, the optical depth is:</p>
<div class="math notranslate nohighlight">
\[ \tau = \int_{z_1}^{z_2} \beta_{\lambda} dz = \int_{z_1}^{z_2} \kappa_{\lambda} \rho (z) dz = \int_{z_1}^{z_2} \sigma_{\lambda} n(z) dz \]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> is the volume absorption coefficient,</p></li>
<li><p><span class="math notranslate nohighlight">\(\kappa\)</span> is the mass absorption coefficient,</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span> is the absorption cross section,</p></li>
</ul>
<p>which all depend on wavelength, <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\rho(z)\)</span> and n(z) are the air density and the number density of the absorbing gas. z is distance along the absorbing path from <span class="math notranslate nohighlight">\(z_1\)</span> to <span class="math notranslate nohighlight">\(z_2\)</span>.</p>
<p>If one conducts an experiment of Beer’s Law in the lab using a tube filled with an absorbing gas (like H2O or CO2), this equation reduces to:</p>
<div class="math notranslate nohighlight">
\[ \tau = \beta (z_2 - z_1) = \kappa_{\lambda} \rho (z_2 - z_1) = \sigma_{\lambda} N (z_2 - z_1) \]</div>
<p>Note that this is how scientists (100 or so years ago) determined how different gases absorbed infrared radiation at different wavelengths, by measuring the transmission of radiation through the gas, calculating the optical depth, then solving for either <span class="math notranslate nohighlight">\(\beta_{\lambda}\)</span>, <span class="math notranslate nohighlight">\(\kappa_{\lambda}\)</span>, or <span class="math notranslate nohighlight">\(\sigma_{\lambda}\)</span>.</p>
<section id="optical-depth-in-the-atmosphere">
<h3>Optical Depth in the Atmosphere<a class="headerlink" href="#optical-depth-in-the-atmosphere" title="Permalink to this heading">#</a></h3>
<p>To determine the optical depth in the atmosphere, one must use the general equation above, because the number of molecules of absorbing gas changes with height in the atmosphere. Carbon dioxide is “uniformly mixed” in the atmosphere, meaning that its concentration relative to other gases does not change with height. However, the actual number of CO2 molecules decreases exponentially with height in the atmosphere because the density (and pressure) of the air decreases in this manner. Most of the water vapor in the atmosphere is contained only in the troposphere in the lowest 7 or 8 km. Therefore, one must integrate through the atmosphere to determine the optical depth using:</p>
<div class="math notranslate nohighlight">
\[ \tau = \int_{z_1}^{z_2} \kappa_{\lambda} \rho (z) dz \]</div>
<p>Here we have chosen to use the specific formula of the optical depth that contains the mass absorption coefficient, because Figure 2 of  Pierrehumbert (2010) gives values of <span class="math notranslate nohighlight">\(\kappa\)</span> for both H2O and CO2.</p>
</section>
</section>
<section id="the-mcclatchey-standard-atmospheres">
<h2>The McClatchey Standard Atmospheres<a class="headerlink" href="#the-mcclatchey-standard-atmospheres" title="Permalink to this heading">#</a></h2>
<p>We’re lucky because <a class="reference external" href="https://apps.dtic.mil/sti/pdfs/AD0753075.pdf">McClatchey et al (1972)</a> [in Optical Properties of the Atmosphere (Third Edition)] created a series of “standard atmospheres” for different locations and seasons on Earth that give us n(z) as a function of altitude (z) in the atmosphere. The McClatchey Standard Atmospheres are for:</p>
<ul class="simple">
<li><p>Tropics             (TRP)</p></li>
<li><p>Mid-latitude Summer (MLS)</p></li>
<li><p>Mid-latitude Winter (MLW)</p></li>
<li><p>Sub-Arctic Summer   (SAS)</p></li>
<li><p>Sub-Arctic Winter   (SAW</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in raw data files</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;layer&#39;</span><span class="p">,</span> <span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;dew_point&#39;</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="s1">&#39;h2o&#39;</span><span class="p">,</span> <span class="s1">&#39;co2&#39;</span><span class="p">,</span> <span class="s1">&#39;o3&#39;</span><span class="p">,</span> <span class="s1">&#39;n2o&#39;</span><span class="p">,</span> <span class="s1">&#39;co&#39;</span><span class="p">,</span> <span class="s1">&#39;ch4&#39;</span><span class="p">,</span> <span class="s1">&#39;o2&#39;</span><span class="p">]</span>
<span class="n">trp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;../trp.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">mls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;../mls.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">mlw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;../mlw.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">sas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;../sas.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">saw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s1">&#39;../saw.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Rair</span> <span class="o">=</span> <span class="mf">287.058</span>        <span class="c1"># J kg-1 K-1</span>
<span class="c1"># Calculate air density</span>
<span class="n">trp</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="s1">&#39;numberDensity&#39;</span><span class="p">})</span>
<span class="n">trp</span><span class="p">[</span><span class="s1">&#39;airDensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">trp</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Rair</span> <span class="o">*</span> <span class="n">trp</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>

<span class="n">mls</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="s1">&#39;numberDensity&#39;</span><span class="p">})</span>
<span class="n">mls</span><span class="p">[</span><span class="s1">&#39;airDensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">mls</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Rair</span> <span class="o">*</span> <span class="n">mls</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>

<span class="n">mlw</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="s1">&#39;numberDensity&#39;</span><span class="p">})</span>
<span class="n">mlw</span><span class="p">[</span><span class="s1">&#39;airDensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">mlw</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Rair</span> <span class="o">*</span> <span class="n">mlw</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>

<span class="n">sas</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="s1">&#39;numberDensity&#39;</span><span class="p">})</span>
<span class="n">sas</span><span class="p">[</span><span class="s1">&#39;airDensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sas</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Rair</span> <span class="o">*</span> <span class="n">sas</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>

<span class="n">saw</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="s1">&#39;numberDensity&#39;</span><span class="p">})</span>
<span class="n">saw</span><span class="p">[</span><span class="s1">&#39;airDensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">saw</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Rair</span> <span class="o">*</span> <span class="n">saw</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interpolate the standard atmospheres to a common grid in meters with heights every 100 meters</span>
<span class="n">trp</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">trp</span><span class="o">.</span><span class="n">altitude</span><span class="o">*</span><span class="mi">1000</span>
<span class="n">trp</span> <span class="o">=</span> <span class="n">trp</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">60001</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="n">mls</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">mls</span><span class="o">.</span><span class="n">altitude</span><span class="o">*</span><span class="mi">1000</span>
<span class="n">mls</span> <span class="o">=</span> <span class="n">mls</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">60001</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="n">mlw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">mlw</span><span class="o">.</span><span class="n">altitude</span><span class="o">*</span><span class="mi">1000</span>
<span class="n">mlw</span> <span class="o">=</span> <span class="n">mlw</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">60001</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="n">sas</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">altitude</span><span class="o">*</span><span class="mi">1000</span>
<span class="n">sas</span> <span class="o">=</span> <span class="n">sas</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">60001</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="n">saw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">saw</span><span class="o">.</span><span class="n">altitude</span><span class="o">*</span><span class="mi">1000</span>
<span class="n">saw</span> <span class="o">=</span> <span class="n">saw</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">60001</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<hr class="docutils" />
<section id="choose-the-standard-atmosphere">
<h2>1) Choose the standard atmosphere<a class="headerlink" href="#choose-the-standard-atmosphere" title="Permalink to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Standard Atmosphere</p></th>
<th class="head"><p>stdatm_name</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Tropical</p></td>
<td><p>‘trp’</p></td>
</tr>
<tr class="row-odd"><td><p>Mid-Latitude Summer</p></td>
<td><p>‘mls’</p></td>
</tr>
<tr class="row-even"><td><p>Mid-Latitude Winter</p></td>
<td><p>‘mlw’</p></td>
</tr>
<tr class="row-odd"><td><p>Sub-Arctic Summer</p></td>
<td><p>‘sas’</p></td>
</tr>
<tr class="row-even"><td><p>Sub-Arctic Winter</p></td>
<td><p>‘saw’</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change this variable to choose the model atmosphere</span>
<span class="c1"># !! NOTE that the single quotation marks are important !!</span>

<span class="n">stdatm_name</span> <span class="o">=</span> <span class="s1">&#39;mlw&#39;</span>

<span class="k">if</span> <span class="s1">&#39;trp&#39;</span> <span class="ow">in</span> <span class="n">stdatm_name</span><span class="p">:</span>
    <span class="n">stdatm</span> <span class="o">=</span> <span class="n">trp</span>
<span class="k">elif</span> <span class="s1">&#39;mls&#39;</span> <span class="ow">in</span> <span class="n">stdatm_name</span><span class="p">:</span>
    <span class="n">stdatm</span> <span class="o">=</span> <span class="n">mls</span>
<span class="k">elif</span> <span class="s1">&#39;mlw&#39;</span> <span class="ow">in</span> <span class="n">stdatm_name</span><span class="p">:</span>
    <span class="n">stdatm</span> <span class="o">=</span> <span class="n">mlw</span>
<span class="k">elif</span> <span class="s1">&#39;sas&#39;</span> <span class="ow">in</span> <span class="n">stdatm_name</span><span class="p">:</span>
    <span class="n">stdatm</span> <span class="o">=</span> <span class="n">sas</span>
<span class="k">elif</span> <span class="s1">&#39;saw&#39;</span> <span class="ow">in</span> <span class="n">stdatm_name</span><span class="p">:</span>
    <span class="n">stdatm</span> <span class="o">=</span> <span class="n">saw</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: This standard atmosphere is NOT RECOGNIZED. Try setting stdatm_name again!!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-the-atmospheric-co2-concentration-in-ppmv">
<h2>2) Set the atmospheric CO2 concentration (in ppmv)<a class="headerlink" href="#set-the-atmospheric-co2-concentration-in-ppmv" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set CO2 in all Standard Atmospheres.</span>
<span class="c1">#co2 = 330.   # ppmv; approximate concentration in 1971</span>
<span class="c1">#co2 = 419.   # ppmv; current concentration in 2023</span>
<span class="c1">#co2 = 280.   # ppmv; pre-industrial concentration</span>
<span class="n">co2</span> <span class="o">=</span> <span class="mf">560.</span>   <span class="c1"># ppmv; doubled CO2 concentration (from pre-industrial)</span>

<span class="n">trp</span><span class="p">[</span><span class="s1">&#39;co2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mls</span><span class="p">[</span><span class="s1">&#39;co2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mlw</span><span class="p">[</span><span class="s1">&#39;co2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sas</span><span class="p">[</span><span class="s1">&#39;co2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">saw</span><span class="p">[</span><span class="s1">&#39;co2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">co2</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<section id="pressure-temperature-and-air-density-in-the-standard-atmospheres">
<h3>Pressure, Temperature, and Air Density in the Standard Atmospheres<a class="headerlink" href="#pressure-temperature-and-air-density-in-the-standard-atmospheres" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Pressure</span>
<span class="n">trp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mls</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mlw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">sas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">saw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pressure (mb)&#39;</span><span class="p">);</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altitude (km)&#39;</span><span class="p">);</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Atmospheric Pressure for Standard Atmospheres&#39;</span><span class="p">);</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;TRP&#39;</span><span class="p">,</span><span class="s1">&#39;MLS&#39;</span><span class="p">,</span><span class="s1">&#39;MLW&#39;</span><span class="p">,</span><span class="s1">&#39;SAS&#39;</span><span class="p">,</span><span class="s1">&#39;SAW&#39;</span><span class="p">]);</span>

<span class="c1"># Temperature</span>
<span class="n">trp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mls</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mlw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">sas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">saw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altitude (km)&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature Profiles for Standard Atmospheres&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;TRP&#39;</span><span class="p">,</span><span class="s1">&#39;MLS&#39;</span><span class="p">,</span><span class="s1">&#39;MLW&#39;</span><span class="p">,</span><span class="s1">&#39;SAS&#39;</span><span class="p">,</span><span class="s1">&#39;SAW&#39;</span><span class="p">]);</span>

<span class="c1">#O3</span>
<span class="n">trp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;airDensity&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mls</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;airDensity&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mlw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;airDensity&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">sas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;airDensity&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">saw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;airDensity&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Density (kg m-3)&#39;</span><span class="p">);</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altitude (km)&#39;</span><span class="p">);</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Density of Air for Standard Atmospheres&#39;</span><span class="p">);</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;TRP&#39;</span><span class="p">,</span><span class="s1">&#39;MLS&#39;</span><span class="p">,</span><span class="s1">&#39;MLW&#39;</span><span class="p">,</span><span class="s1">&#39;SAS&#39;</span><span class="p">,</span><span class="s1">&#39;SAW&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/eb3fb3376586d87fdef8a18de13f9f63787c7087779268bc11223a4d5e0a3e3a.png" src="../_images/eb3fb3376586d87fdef8a18de13f9f63787c7087779268bc11223a4d5e0a3e3a.png" />
</div>
</div>
</section>
<section id="primary-greenhouse-gas-concentrations-in-standard-atmospheres">
<h3>Primary Greenhouse Gas Concentrations in Standard Atmospheres<a class="headerlink" href="#primary-greenhouse-gas-concentrations-in-standard-atmospheres" title="Permalink to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># H2O</span>
<span class="n">trp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;h2o&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mls</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;h2o&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mlw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;h2o&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">sas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;h2o&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">saw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;h2o&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Water Vapor (ppmv)&#39;</span><span class="p">);</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altitude (km)&#39;</span><span class="p">);</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Water Vapor concentration for Standard Atmospheres&#39;</span><span class="p">);</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;TRP&#39;</span><span class="p">,</span><span class="s1">&#39;MLS&#39;</span><span class="p">,</span><span class="s1">&#39;MLW&#39;</span><span class="p">,</span><span class="s1">&#39;SAS&#39;</span><span class="p">,</span><span class="s1">&#39;SAW&#39;</span><span class="p">]);</span>

<span class="c1"># CO2</span>
<span class="n">trp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;co2&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mls</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;co2&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mlw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;co2&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">sas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;co2&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">saw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;co2&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Carbon Dioxide (ppmv)&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altitude (km)&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Carbon Dioxide concentration for Standard Atmospheres&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;TRP&#39;</span><span class="p">,</span><span class="s1">&#39;MLS&#39;</span><span class="p">,</span><span class="s1">&#39;MLW&#39;</span><span class="p">,</span><span class="s1">&#39;SAS&#39;</span><span class="p">,</span><span class="s1">&#39;SAW&#39;</span><span class="p">]);</span>

<span class="c1">#O3</span>
<span class="n">trp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;o3&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mls</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;o3&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">mlw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;o3&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">sas</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;o3&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">saw</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;o3&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Ozone (ppmv)&#39;</span><span class="p">);</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altitude (km)&#39;</span><span class="p">);</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Ozone concentration for Standard Atmospheres&#39;</span><span class="p">);</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;TRP&#39;</span><span class="p">,</span><span class="s1">&#39;MLS&#39;</span><span class="p">,</span><span class="s1">&#39;MLW&#39;</span><span class="p">,</span><span class="s1">&#39;SAS&#39;</span><span class="p">,</span><span class="s1">&#39;SAW&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/fbf634d1e7f52665ced6eed6bb36f4ee1b3a6a55904b60ce26a443f8a7252625.png" src="../_images/fbf634d1e7f52665ced6eed6bb36f4ee1b3a6a55904b60ce26a443f8a7252625.png" />
</div>
</div>
</section>
</section>
<section id="calculating-optical-depth">
<h2>Calculating Optical Depth<a class="headerlink" href="#calculating-optical-depth" title="Permalink to this heading">#</a></h2>
<p>Now that we have values for the air density and the concentrations of the greenhouse gases, it is easy to calculate the optical depth for individual gases.</p>
<p>We will use mass absorption coefficients for carbon dioxide at the following wavelengths (from the center of the 15-um CO2 band towards the atmospheric window between 8 and 12.5 um):</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Type of Absorption</p></th>
<th class="head"><p>Wavenumber (<span class="math notranslate nohighlight">\(cm^{-1}\)</span>)</p></th>
<th class="head"><p>Wavelength (<span class="math notranslate nohighlight">\(\mu\)</span>m)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\kappa_a\)</span> (<span class="math notranslate nohighlight">\(m^2 kg^{-1}\)</span>)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Very Strong</p></td>
<td><p>667</p></td>
<td><p>15</p></td>
<td><p>2000</p></td>
</tr>
<tr class="row-odd"><td><p>Very Strong</p></td>
<td><p>714</p></td>
<td><p>14</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>Moderate</p></td>
<td><p>769</p></td>
<td><p>13</p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-odd"><td><p>Weak</p></td>
<td><p>833</p></td>
<td><p>12</p></td>
<td><p>0.001</p></td>
</tr>
</tbody>
</table>
<p>These mass absorption coefficients values were <em>approximated</em> from Figure 2 in Pierrehumbert, Physics Today, January 2011.</p>
<p>So, the optical depth can now be calculated for each layer of the atmosphere by multiplying the absorption cross sections (<span class="math notranslate nohighlight">\(\kappa_a\)</span>) by the air density, and then by the thickness of the atmospheric layer, as shown in the code below (for the Mid-latitude Winter Standard Atmosphere - MLW).</p>
<p><strong>Disclaimer:</strong> Please note that this calculation of optical depth is for illustrative purposes only, and is over-simplified in the following ways:</p>
<ul class="simple">
<li><p>In most cases H2O overlaps the absorption bands of all the other GH gases. (See Figure 2 of Pierrehumbert (2010); blowup of 600-670 cm-1).</p></li>
<li><p>We are neglecting how the line strengths of absorption lines depend on temperature in the atmosphere (<a class="reference external" href="https://hitran.org/docs/definitions-and-units/">https://hitran.org/docs/definitions-and-units/</a>)</p></li>
<li><p>We are neglecting how the widths of absorption lines depend on both temperature and pressure (<a class="reference external" href="https://hitran.org/docs/definitions-and-units/">https://hitran.org/docs/definitions-and-units/</a>)</p></li>
</ul>
<p>Accurate radiative transfer models of the atmosphere account for all of this issues.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ka_15</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">Ka_14</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Ka_13</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Ka_12</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="n">rhoCO2</span> <span class="o">=</span> <span class="n">stdatm</span><span class="o">.</span><span class="n">airDensity</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">stdatm</span><span class="o">.</span><span class="n">co2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span>     <span class="c1"># Convert from ppmv to percent fraction</span>
<span class="n">dz</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">stdatm</span><span class="o">.</span><span class="n">altitude</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>                 <span class="c1"># Calculate the height of each layer by differencing levels; meters</span>

<span class="c1"># Calculate and plot the optical depth at 14.6 um for CO2 for the MLW Standard Atmosphere.</span>
<span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;od_15&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ka_15</span> <span class="o">*</span> <span class="n">rhoCO2</span> <span class="o">*</span> <span class="n">dz</span>
<span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;od_14&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ka_14</span> <span class="o">*</span> <span class="n">rhoCO2</span> <span class="o">*</span> <span class="n">dz</span>
<span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;od_13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ka_13</span> <span class="o">*</span> <span class="n">rhoCO2</span> <span class="o">*</span> <span class="n">dz</span>
<span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;od_12&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ka_12</span> <span class="o">*</span> <span class="n">rhoCO2</span> <span class="o">*</span> <span class="n">dz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;od_15&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;od_14&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;od_13&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;od_12&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Optical Depth&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altitude (km)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Infrared Optical Depths for CO2 in &#39;</span> <span class="o">+</span> <span class="n">stdatm_name</span> <span class="o">+</span> <span class="s1">&#39;Standard Atmospheres&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;15 um&#39;</span><span class="p">,</span><span class="s1">&#39;14 um&#39;</span><span class="p">,</span><span class="s1">&#39;13 um&#39;</span><span class="p">,</span><span class="s1">&#39;12 um&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/bb2588f349f1edc2af003408d009f09d4426c5e59736d7856cf279bf5786e018.png" src="../_images/bb2588f349f1edc2af003408d009f09d4426c5e59736d7856cf279bf5786e018.png" />
</div>
</div>
</section>
<section id="calculating-atmospheric-transmission">
<h2>Calculating Atmospheric Transmission<a class="headerlink" href="#calculating-atmospheric-transmission" title="Permalink to this heading">#</a></h2>
<section id="as-a-function-of-altitude">
<h3>As a function of altitude<a class="headerlink" href="#as-a-function-of-altitude" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;T_15&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_15</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;T_14&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_14</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;T_13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_13</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;T_12&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_12</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;T_15&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;T_14&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;T_13&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;T_12&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Transmission&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altitude (km)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Infrared Transmission for CO2 in &#39;</span> <span class="o">+</span> <span class="n">stdatm_name</span> <span class="o">+</span> <span class="s1">&#39;Standard Atmospheres&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;15 um&#39;</span><span class="p">,</span><span class="s1">&#39;14 um&#39;</span><span class="p">,</span><span class="s1">&#39;13 um&#39;</span><span class="p">,</span><span class="s1">&#39;12 um&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/65b9c545bbd9df4cca22deea5b97913e11952fa86faa46076f2d1246660da1fa.png" src="../_images/65b9c545bbd9df4cca22deea5b97913e11952fa86faa46076f2d1246660da1fa.png" />
</div>
</div>
</section>
<section id="transmission-through-the-entire-atmosphere">
<h3>Transmission through the entire atmosphere<a class="headerlink" href="#transmission-through-the-entire-atmosphere" title="Permalink to this heading">#</a></h3>
<p>The above figure shows the transmission as a function of altitude in the atmosphere. But how do we calculate the transmission through the entire atmosphere?</p>
<p>There are two ways to do this:</p>
<ol class="arabic simple">
<li><p>Multiply all the transmission from each layer together, or</p></li>
</ol>
<div class="math notranslate nohighlight">
\[ T_{total} = e^{- \tau_1} e^{- \tau_2} e^{- \tau_3} ... \]</div>
<ol class="arabic simple" start="2">
<li><p>Or (because of the properties of exponents) one can just add up all the optical depths for each layer and take the exponential of that sum</p></li>
</ol>
<div class="math notranslate nohighlight">
\[ T_{total} = e^{- \tau_1} e^{- \tau_2} e^{- \tau_3} ... = e^{- (\tau_1 +  \tau_2 + \tau_3 ...)} \]</div>
<p>Option 2 is much easier for us here; see the code below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate total transmission in the atmosphere by summing all optical depths</span>
<span class="n">Ttotal_15</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_15</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">Ttotal_14</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_14</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">Ttotal_13</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_13</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">Ttotal_12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_12</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># Print results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total transmission in atmosphere (%) at 15 um = </span><span class="si">{</span><span class="n">Ttotal_15</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total transmission in atmosphere (%) at 14 um = </span><span class="si">{</span><span class="n">Ttotal_14</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total transmission in atmosphere (%) at 13 um = </span><span class="si">{</span><span class="n">Ttotal_13</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total transmission in atmosphere (%) at 12 um = </span><span class="si">{</span><span class="n">Ttotal_12</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total transmission in atmosphere (%) at 15 um = 0.00 %
Total transmission in atmosphere (%) at 14 um = 0.00 %
Total transmission in atmosphere (%) at 13 um = 55.59 %
Total transmission in atmosphere (%) at 12 um = 99.41 %
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="calculating-atmospheric-absorption-and-emissivity">
<h2>Calculating Atmospheric Absorption and Emissivity<a class="headerlink" href="#calculating-atmospheric-absorption-and-emissivity" title="Permalink to this heading">#</a></h2>
<p>An important property of thermal radiation is given by <a class="reference external" href="https://en.wikipedia.org/wiki/Kirchhoff%27s_law_of_thermal_radiation">Kirchhoff’s Law</a>. It states that</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;For an arbitrary body emitting and absorbing thermal radiation in thermodynamic equilibrium, the emissivity is equal to the absorptivity.&quot;</span>
</pre></div>
</div>
<p>We don’t have time to discuss this in CE401, but it states that a good emitter (high emissivity object) is an equally good absorber.</p>
<p>This holds true for the atmosphere as well. So, if we calculate the absorption of the atmosphere as</p>
<div class="math notranslate nohighlight">
\[ Absorption = 1 - Transmission \]</div>
<p>then also</p>
<div class="math notranslate nohighlight">
\[ Emissivity = 1 - Transmission \]</div>
<section id="id1">
<h3>As a function of altitude<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;A_15&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_15</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>        <span class="c1"># Convert from fraction to percent</span>
<span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;A_14&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_14</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;A_13&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_13</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">stdatm</span><span class="p">[</span><span class="s1">&#39;A_12&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">stdatm</span><span class="o">.</span><span class="n">od_12</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;A_15&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;A_14&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;A_13&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stdatm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;A_12&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;altitude&#39;</span><span class="p">,</span> <span class="n">logx</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Absorption&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Altitude (km)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Infrared Absorption for CO2 in &#39;</span> <span class="o">+</span> <span class="n">stdatm_name</span> <span class="o">+</span> <span class="s1">&#39;Standard Atmospheres&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;15 um&#39;</span><span class="p">,</span><span class="s1">&#39;14 um&#39;</span><span class="p">,</span><span class="s1">&#39;13 um&#39;</span><span class="p">,</span><span class="s1">&#39;12 um&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/a22c3248005be5204c5b1935c64246edf4f226e2d3f2cfd7a7f7c7b4ad1b40f9.png" src="../_images/a22c3248005be5204c5b1935c64246edf4f226e2d3f2cfd7a7f7c7b4ad1b40f9.png" />
</div>
</div>
</section>
<section id="absorption-by-the-entire-atmosphere">
<h3>Absorption by the entire atmosphere<a class="headerlink" href="#absorption-by-the-entire-atmosphere" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total absorption in atmosphere (%) at 15 um = </span><span class="si">{</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Ttotal_15</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total absorption in atmosphere (%) at 14 um = </span><span class="si">{</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Ttotal_14</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total absorption in atmosphere (%) at 13 um = </span><span class="si">{</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Ttotal_13</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total absorption in atmosphere (%) at 12 um = </span><span class="si">{</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Ttotal_12</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total absorption in atmosphere (%) at 15 um = 100.00 %
Total absorption in atmosphere (%) at 14 um = 100.00 %
Total absorption in atmosphere (%) at 13 um = 44.41 %
Total absorption in atmosphere (%) at 12 um = 0.59 %
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Insolation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Insolation</p>
      </div>
    </a>
    <a class="right-next"
       href="EquilibriumTemperatureOfEarth.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Calculation of the Equilibrium Temperature of Earth</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-of-the-optical-depth">Definition of the Optical Depth</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optical-depth-in-the-atmosphere">Optical Depth in the Atmosphere</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-mcclatchey-standard-atmospheres">The McClatchey Standard Atmospheres</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choose-the-standard-atmosphere">1) Choose the standard atmosphere</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-atmospheric-co2-concentration-in-ppmv">2) Set the atmospheric CO2 concentration (in ppmv)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pressure-temperature-and-air-density-in-the-standard-atmospheres">Pressure, Temperature, and Air Density in the Standard Atmospheres</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#primary-greenhouse-gas-concentrations-in-standard-atmospheres">Primary Greenhouse Gas Concentrations in Standard Atmospheres</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-optical-depth">Calculating Optical Depth</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-atmospheric-transmission">Calculating Atmospheric Transmission</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#as-a-function-of-altitude">As a function of altitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transmission-through-the-entire-atmosphere">Transmission through the entire atmosphere</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-atmospheric-absorption-and-emissivity">Calculating Atmospheric Absorption and Emissivity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">As a function of altitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#absorption-by-the-entire-atmosphere">Absorption by the entire atmosphere</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Von P. Walden, Washington State University
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>